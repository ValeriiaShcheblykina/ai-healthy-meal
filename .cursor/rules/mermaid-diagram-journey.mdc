---
description:
globs:
alwaysApply: false
---
# Mermaid Diagram - User Journey

You are a UX specialist tasked with creating a Mermaid diagram to visualize the user journey for the login and registration module. The diagram should be created in the following file: DESTINATION

You will need to refer to the following files to understand existing requirements:

<file_references>
@prd.md
</file_references>

<destination>
.ai/diagrams/journey.md
</destination>

Your task is to analyze the specifications of the login and registration module and create a comprehensive Mermaid diagram that accurately represents the user journey. The diagram should be in Polish.

Before creating the diagram, analyze the requirements and plan your approach. Place your analysis inside the <user_journey_analysis> tags. In this analysis:

1. List all user paths mentioned in the reference files.
2. Identify the main journeys and their corresponding states.
3. Define decision points and alternative paths.
4. Provide a short description of each state's purpose.

When you are ready to create the diagram, follow these guidelines:

1. Start the diagram with the following syntax:

   ```mermaid
   stateDiagram-v2
   ```

2. Include the following elements in your diagram:

   - User paths based on existing requirements
   - Using the app as an unauthenticated user
   - Accessing the main functionality of the app
   - Logging in
   - Creating an account
   - Recovering a password
   - High-level user journey according to project requirements and USER STORIES
   - Decision points and alternative paths
   - Post-email verification flow
   - Focus on business paths rather than technical details

3. Follow these Mermaid syntax rules:

   - Initial and final states must be properly defined:
     ```
     [*] --> HomePage
     HomePage --> [*]
     ```
   - Use composite states to group related states:
     ```
     state "Registration Process" as Registration {
       [*] --> RegistrationForm
       RegistrationForm --> DataValidation
       DataValidation --> SendEmail
     }
     ```
   - For decision branches, use correct syntax:
     ```
     state if_verification <<choice>>
     TokenVerification --> if_verification
     if_verification --> TokenValid: Token OK
     if_verification --> TokenInvalid: Invalid token
     ```
   - Use notes for additional context:
     ```
     LoginForm: User can log in
     note right of LoginForm
       The form includes email and password fields
       and a link to password recovery
     end note
     ```
   - For parallel states, use correct syntax:
     ```
     state fork_state <<fork>>
     state join_state <<join>>

     Registration --> fork_state
     fork_state --> SendEmail
     fork_state --> UpdateDatabase
     SendEmail --> join_state
     UpdateDatabase --> join_state
     join_state --> FinalState
     ```
   - Use namespaces to organize complex diagrams:
     ```
     state "Authentication" as Auth {
       state "Login" as Login {
         // states for login process
       }
       state "Registration" as Registration {
         // states for registration process
       }
     }
     ```
   - For state history, use proper syntax:
     ```
     state "User Dashboard" as Dashboard {
       [*] --> history
       state history <<history>>
     }
     ```
   - For transitions with events and conditions, use correct syntax:
     ```
     StateA --> StateB: Next Button [valid data]
     ```
   - Avoid using URLs, endpoints, parentheses, long function names, or complex expressions in state names:
     BAD: [Home Page<br/>(Rules Builder)]
     GOOD: [Rules Builder]
   - Use consistent naming throughout the document
   - Avoid overly long labels that may cause rendering issues

4. Avoid these common mistakes:
   - Missing Mermaid section and diagram type declaration at the start
   - Incorrect decision states (missing choice, fork, join)
   - Missing initial or final states ([*])
   - Inconsistent state naming
   - Unclosed nested states (missing closing curly brace)
   - Overly complex diagrams without proper state grouping
   - Incorrect transition labels
   - Exceeding line length limits
   - Missing blank lines before and after Mermaid code blocks

After creating the diagram, review it carefully to ensure there are no syntax or rendering errors. Make necessary corrections to improve clarity and accuracy.

When ready to present the final diagram, wrap it with <mermaid_diagram> tags.
